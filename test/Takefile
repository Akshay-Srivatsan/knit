set obj [extrepl [glob *.c] .c .o]
set prog hello

setdef cc gcc
setdef debug 0
set cflags -Wall

setdef lld 0
set ldflags ""

if {$debug} {
    set cflags "$cflags -Og -g -fsanitize=address,undefined"
} else {
    set cflags "$cflags -O2"
}

if {$lld} {
    set ldflags "-fuse-ld=lld"
}

set date [shell date]

rules {

%.o: %.c
    $cc $cflags -c $in -o $out
$prog: $obj
    $cc $ldflags $cflags $in -o $out
clean:V:
    rm -f $obj $prog
echo-%:VQ:
    echo ${expr "\$$stem"}

}
